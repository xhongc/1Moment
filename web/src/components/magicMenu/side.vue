<template>
    <div class="z-[20]">
        <a class="btn btn-ghost normal-case text-xl">Chanson 香颂</a>

        <ul class="menu bg-base-100 rounded-box w-48">
            <li :class="[$route.name == 'index' ? 'bg-neutral' : '', 'rounded-xl']" v-if="role === 'V2'" @click="showSideBar">
                <router-link class="nav-link" :to="{path: '/index'}">
                    <svg xmlns="http://www.w3.org/2000/svg" :class="['h-5', 'w-5', $route.name == 'index' ? 'fill-neutral-content' : '']" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" /></svg>
                    <div :class="[$route.name == 'index' ? 'text-neutral-content' : '', 'text-base']">首页</div>
                </router-link>
            </li>

            <li :class="[$route.name == 'home' ? 'bg-neutral' : '', 'rounded-xl']" @click="showSideBar">
                <router-link class="nav-link" :to="{path: '/'}">
                    <svg t="1709776900830" :class="['h-5', 'w-5', $route.name == 'home' ? 'fill-neutral-content' : 'fill-current']" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10126" width="200" height="200"><path d="M304.697598 824.441653a291.891313 291.891313 0 1 1 291.891313-291.891313 292.48701 292.48701 0 0 1-291.891313 291.891313zM304.697598 298.441593a232.321658 232.321658 0 1 0 232.321657 232.321657A232.917354 232.917354 0 0 0 304.697598 298.441593z"></path><path d="M304.697598 674.921817a142.371477 142.371477 0 1 1 141.775781-142.371477 142.371477 142.371477 0 0 1-141.775781 142.371477z m0-224.577602a82.801822 82.801822 0 1 0 82.206125 82.206125A82.801822 82.801822 0 0 0 304.697598 450.344215zM53.909347 677.304603l58.378263-12.509627 74.34293 346.754966-58.378263 12.509628zM537.9128 541.307079l56.769882-17.990036 143.562871 452.550675-56.769882 17.990036zM192.587506 262.401951l494.070725-193.89923 21.742924 55.39978-494.070725 193.958799z"></path><path d="M548.456629 531.001529l283.84941-218.14408 36.33749 47.238737L584.67498 578.240266z"></path><path d="M828.910569 365.755304a182.878843 182.878843 0 1 1 110.799559-327.633107 29.784828 29.784828 0 0 1 11.318235 26.210648 28.593435 28.593435 0 0 1-16.083807 23.827863l-69.100801 36.33749 26.806345 51.229904L965.920777 137.603522a27.997738 27.997738 0 0 1 27.402042 0 29.189131 29.189131 0 0 1 16.083807 22.636469v23.232166a182.283147 182.283147 0 0 1-180.496057 182.283147z m0-305.592334a123.309187 123.309187 0 1 0 119.139311 154.285408l-54.208386 27.997738a29.784828 29.784828 0 0 1-22.63647 0 28.593435 28.593435 0 0 1-17.2752-14.892414l-54.208387-104.246897a29.189131 29.189131 0 0 1 12.509628-39.91167l42.890152-22.040772A131.053243 131.053243 0 0 0 828.910569 60.16297z"></path></svg>
                    <div :class="[$route.name == 'home' ? 'text-neutral-content' : '', 'text-base']">操作台</div>
                </router-link>
            </li>

            <li :class="[$route.name == 'log' ? 'bg-neutral' : '', 'rounded-xl']" @click="showSideBar">
                <router-link class="nav-link" :to="{path: '/log'}">
                    <svg t="1711530514459" :class="['h-5', 'w-5', $route.name == 'log' ? 'fill-neutral-content' : 'fill-current']" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4363" width="200" height="200"><path d="M783.53 240.47C641.08 98.02 413.8 91.41 263.09 220.03V167.1c0-17.67-14.33-32-32-32s-32 14.33-32 32v128c0 17.67 14.33 32 32 32h128c17.67 0 32-14.33 32-32s-14.33-32-32-32h-48.15c125.55-101.54 310.66-94.06 427.34 22.62 124.75 124.77 124.75 327.8 0 452.56-124.78 124.75-327.78 124.75-452.56 0C225.28 677.84 192 597.48 192 512c0-17.67-14.33-32-32-32s-32 14.33-32 32c0 102.58 39.94 199.02 112.47 271.53 74.86 74.86 173.19 112.3 271.53 112.3 98.33 0 196.67-37.44 271.53-112.3 149.7-149.72 149.7-393.34 0-543.06z" p-id="4364"></path><path d="M512 288c-17.67 0-32 14.33-32 32v185.38c0 12.81 5 24.88 14.06 33.94l123.31 123.31c6.25 6.25 14.44 9.38 22.62 9.38s16.38-3.12 22.62-9.38c12.5-12.5 12.5-32.75 0-45.25L544 498.75V320c0-17.67-14.33-32-32-32z"></path></svg>
                    <div :class="[$route.name == 'log' ? 'text-neutral-content' : '', 'text-base']">操作记录</div>
                </router-link>
            </li>

            <li :class="[$route.name == 'mod' ? 'bg-neutral' : '', 'rounded-xl']" v-if="role === 'V2'" @click="showSideBar">
                <router-link class="nav-link" :to="{path: '/mod'}">
                    <svg t="1711530558637" :class="['h-5', 'w-5', $route.name == 'mod' ? 'fill-neutral-content' : 'fill-current']" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5457" width="200" height="200"><path d="M627.2 960H166.4c-25.6 0-51.2-12.8-70.4-25.6-19.2-19.2-32-44.8-32-70.4v-115.2c6.4-19.2 12.8-38.4 32-51.2 12.8-6.4 19.2-12.8 32-12.8s25.6 6.4 44.8 12.8H192c12.8 6.4 19.2 6.4 32 6.4s25.6 0 32-6.4c12.8-6.4 19.2-12.8 25.6-19.2 6.4-6.4 12.8-19.2 19.2-25.6 6.4-12.8 6.4-19.2 6.4-32s0-25.6-6.4-32c-6.4-12.8-12.8-19.2-19.2-25.6s-19.2-12.8-25.6-19.2c-12.8-6.4-19.2-6.4-32-6.4s-19.2 0-32 6.4h-6.4-6.4c-6.4 6.4-19.2 6.4-25.6 12.8-12.8 6.4-25.6 6.4-38.4 6.4-19.2 0-32-12.8-38.4-25.6-6.4-12.8-12.8-25.6-12.8-44.8V390.4c0-25.6 12.8-51.2 32-70.4 19.2-19.2 44.8-32 70.4-32h83.2c-6.4-19.2-6.4-32-6.4-51.2 0-25.6 6.4-51.2 12.8-70.4l38.4-57.6c19.2-19.2 38.4-32 57.6-38.4 25.6-12.8 44.8-12.8 70.4-12.8s51.2 6.4 70.4 12.8l57.6 38.4c19.2 19.2 32 38.4 38.4 57.6 12.8 25.6 12.8 44.8 12.8 70.4 0 19.2 0 38.4-6.4 51.2h25.6c25.6 0 51.2 12.8 70.4 32 19.2 19.2 25.6 44.8 25.6 70.4v460.8c0 25.6-12.8 51.2-25.6 70.4-12.8 25.6-38.4 38.4-64 38.4z m-486.4-192v96c0 6.4 0 12.8 6.4 19.2 6.4 6.4 12.8 6.4 19.2 6.4h460.8c6.4 0 12.8 0 19.2-6.4 6.4-6.4 6.4-12.8 6.4-19.2V403.2c0-6.4 0-12.8-6.4-19.2-6.4-6.4-6.4-6.4-19.2-6.4H454.4l51.2-64c19.2-19.2 25.6-38.4 25.6-64 0-12.8 0-32-6.4-44.8-6.4-12.8-12.8-25.6-25.6-32-12.8-12.8-19.2-19.2-32-25.6-12.8-6.4-25.6-6.4-44.8-6.4-12.8 0-25.6 0-44.8 6.4-12.8 6.4-25.6 12.8-32 25.6-12.8 12.8-19.2 19.2-25.6 32-6.4 12.8-6.4 25.6-6.4 44.8 0 12.8 0 25.6 6.4 38.4 6.4 12.8 12.8 25.6 19.2 32l51.2 64H166.4c-6.4 0-12.8 0-19.2 6.4-6.4 6.4-6.4 12.8-6.4 19.2v89.6s6.4 0 6.4-6.4c6.4 0 6.4-6.4 12.8-6.4 19.2-6.4 38.4-12.8 64-12.8 19.2 0 44.8 6.4 64 12.8 19.2 6.4 38.4 19.2 51.2 32 12.8 12.8 25.6 32 32 51.2 6.4 19.2 12.8 38.4 12.8 64 0 19.2-6.4 44.8-12.8 64-6.4 19.2-19.2 38.4-32 51.2-12.8 12.8-32 25.6-51.2 32-19.2 6.4-38.4 12.8-64 12.8-19.2 0-44.8-6.4-64-12.8-6.4-6.4-12.8-12.8-19.2-12.8z m646.4-358.4h140.8c19.2 0 32 12.8 32 32V448c0 19.2-12.8 32-32 32h-140.8c-19.2 0-32-12.8-32-32v-6.4c0-19.2 12.8-32 32-32z m0 134.4h140.8c19.2 0 32 12.8 32 32v6.4c0 19.2-12.8 32-32 32h-140.8c-19.2 0-32-12.8-32-32V576c0-12.8 12.8-32 32-32z m0 140.8h140.8c19.2 0 32 12.8 32 32v6.4c0 19.2-12.8 32-32 32h-140.8c-19.2 0-32-12.8-32-32v-6.4c0-19.2 12.8-32 32-32z m0 134.4h140.8c19.2 0 32 12.8 32 32v6.4c0 19.2-12.8 32-32 32h-140.8c-19.2 0-32-12.8-32-32v-6.4c0-12.8 12.8-32 32-32z" p-id="5458"></path></svg>
                    <div :class="[$route.name == 'mod' ? 'text-neutral-content' : '', 'text-base']">插件管理</div>
                </router-link>
            </li>

            <li>
                <details open v-if="role === 'V2'">
                    <summary>
                        <div class="nav-link flex justify-center items-center">
                            <svg t="1699584295731" class="h-5 w-5 fill-current" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1185" width="64" height="64"><path d="M64 511.5C64 263.8 264.8 63 512.5 63S961 263.8 961 511.5V752c0 61.856-50.144 112-112 112h-56c-61.856 0-112-50.144-112-112V584c0-61.856 50.144-112 112-112h85.908C859.199 287.057 702.673 143 512.5 143S165.8 287.057 146.092 472H232c61.856 0 112 50.144 112 112v168c0 61.856-50.144 112-112 112h-56c-61.856 0-112-50.144-112-112V512v-0.25-0.25zM881 552h-88c-17.673 0-32 14.327-32 32v168c0 17.673 14.327 32 32 32h56c17.673 0 32-14.327 32-32V552z m-737 0v200c0 17.673 14.327 32 32 32h56c17.673 0 32-14.327 32-32V584c0-17.673-14.327-32-32-32h-88z"  p-id="1186"></path></svg>
                            <div class="text-base ml-2">音乐收藏</div>
                        </div>
                    </summary>
                    <SidebarNav />
                </details>
            </li>

            <li :class="[$route.name == 'system' ? 'bg-neutral' : '', 'rounded-xl']" v-if="role === 'V2'" @click="showSideBar">
                <router-link class="nav-link" :to="{path: '/system'}">
                    <svg t="1711530804117" :class="['h-5', 'w-5', $route.name == 'system' ? 'fill-neutral-content' : 'fill-current']" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6468" width="200" height="200"><path d="M609.555 902.043c-13.725 0.001-26.804-7.476-33.571-20.353l-34.935-66.459a306.923 306.923 0 0 1-58.066-0.061l-34.966 66.521a37.887 37.887 0 0 1-47.882 17.552l-77.863-31.458a37.888 37.888 0 0 1-22.247-45.886l21.167-72.521a305.362 305.362 0 0 1-44.334-43.685l-72.229 22.457a37.894 37.894 0 0 1-46.268-21.44l-32.815-77.308a37.89 37.89 0 0 1 16.717-48.178l66.47-36.435a308.288 308.288 0 0 1-1.849-33.667c0-9.438 0.442-18.921 1.318-28.369l-67.106-35.274a37.891 37.891 0 0 1-17.555-47.878L155 321.735a37.887 37.887 0 0 1 45.889-22.246l72.625 21.198a305.344 305.344 0 0 1 43.551-44.451l-22.431-72.145a37.891 37.891 0 0 1 21.441-46.268l77.308-32.815a37.887 37.887 0 0 1 48.177 16.717l36.125 65.905a307.922 307.922 0 0 1 68.672-0.074l36.085-65.831a37.889 37.889 0 0 1 48.179-16.716l77.304 32.814a37.89 37.89 0 0 1 21.443 46.268l-22.29 71.692a305.403 305.403 0 0 1 43.96 44.743l72.076-21.037a37.888 37.888 0 0 1 45.888 22.248l31.46 77.865a37.894 37.894 0 0 1-17.553 47.878l-66.461 34.936a307.563 307.563 0 0 1 1.35 28.709c0 11.345-0.634 22.724-1.89 34.018l65.831 36.083a37.89 37.89 0 0 1 16.715 48.184l-32.812 77.301a37.89 37.89 0 0 1-46.267 21.442l-71.692-22.29a305.459 305.459 0 0 1-44.744 43.96l21.038 72.077a37.888 37.888 0 0 1-22.249 45.888l-77.864 31.459a38.165 38.165 0 0 1-14.309 2.796z m-35.191-152.387l45.471 86.504 40.968-16.552-27.388-93.835 17.87-12.297c23.731-16.329 44.241-36.479 60.96-59.893l12.606-17.654 93.334 29.02 17.265-40.674-85.688-46.969 3.936-21.327a247.749 247.749 0 0 0 4.1-44.855c0-13.55-1.132-27.22-3.365-40.631l-3.562-21.392 86.506-45.472-16.553-40.968-93.834 27.388-12.296-17.871c-16.33-23.731-36.48-44.24-59.894-60.959l-17.654-12.606 29.02-93.334-40.674-17.265-46.97 85.688-21.327-3.936c-29.65-5.471-60.574-5.442-90.257 0.105l-21.37 3.994-47.058-85.852-40.673 17.265 29.128 93.685-17.577 12.617a246.108 246.108 0 0 0-59.502 60.746l-12.293 17.893-94.415-27.558-16.552 40.969 87.105 45.786-3.53 21.368a248.19 248.19 0 0 0-3.316 40.34c0 14.931 1.36 29.921 4.042 44.556l3.904 21.304-86.278 47.292 17.265 40.674 93.905-29.196 12.603 17.678c16.611 23.3 36.989 43.386 60.569 59.699l17.792 12.309-27.486 94.17 40.969 16.552 45.549-86.653 21.434 3.617a248.147 248.147 0 0 0 41.19 3.457c13.548 0 27.219-1.132 40.634-3.364l21.387-3.563z" p-id="6469"></path><path d="M512 613.906c-56.191 0-101.906-45.715-101.906-101.906S455.809 410.094 512 410.094 613.906 455.809 613.906 512 568.191 613.906 512 613.906z m0-143.812c-23.107 0-41.906 18.799-41.906 41.906s18.799 41.906 41.906 41.906 41.906-18.799 41.906-41.906-18.799-41.906-41.906-41.906z" p-id="6470"></path></svg>
                    <div :class="[$route.name == 'system' ? 'text-neutral-content' : '', 'text-base']">系统设置</div>
                </router-link>
            </li>

        </ul>
    </div>
</template>
<script lang="ts" setup>
import SidebarNav from '../library/SidebarNav.vue'
import { ref, computed } from 'vue'
import { useRoute, useRouter } from 'vue-router'
import { useUserStore } from '@/stores/user' // 假设你的用户store在这个位置

interface HeaderItem {
    name: string
    id: number
    show: boolean
    pathName: string
    role: string
}

const userStore = useUserStore()
const route = useRoute()
const router = useRouter()

const header = ref({
    list: [
        {
            name: '首页',
            id: 3,
            show: true,
            pathName: 'index',
            role: 'V2'
        },
        {
            name: '操作台', 
            id: 1,
            show: true,
            pathName: 'home',
            role: 'V1'
        },
        {
            name: '操作记录',
            id: 6, 
            show: true,
            pathName: 'log',
            role: 'V1'
        },
        {
            name: '插件管理',
            id: 4,
            show: true,
            pathName: 'mod',
            role: 'V2'
        },
        {
            name: '音乐收藏',
            id: 2,
            show: true,
            pathName: 'library',
            role: 'V2'
        },
        {
            name: '系统设置',
            id: 5,
            show: true,
            pathName: 'system',
            role: 'V2'
        }
    ],
    active: -1,
})

// 从用户store获取角色
const role = computed(() => userStore.userRole || 'V1')

const navName = computed(() => {
    return route.meta.hasOwnProperty('fatherName') ? route.meta.fatherName : route.name
})

const redirectUrl = (item: HeaderItem) => {
    header.value.active = item.id
    if (item.pathName === 'library') {
        router.push({path: '/albums/recently-added/'})
    } else {
        router.push({name: item.pathName})
    }
}

const showSideBar = () => {
    // @ts-ignore
    parent.showSideBar()
}

</script>
<style>
</style>
